<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VOTE | Miss Seven Queen 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    
    <style>
        :root {
            --gold: #d4af37;
            --gold-light: #f9e29c;
            --bg: #121212;
            --card-bg: #1e1e1e;
            --text: #ffffff;
        }

        body {
            font-family: 'Prompt', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            padding-bottom: 50px;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- Header --- */
        .header {
            text-align: center;
            padding: 25px 20px;
            background: linear-gradient(to bottom, #000000, #1a1a1a);
            border-bottom: 1px solid var(--gold);
        }

        .header h1 { margin: 0; color: var(--gold); text-transform: uppercase; font-size: 20px; letter-spacing: 1px; }
        .header p { color: #aaa; font-size: 12px; margin-top: 5px; }

        /* --- Grid Layout --- */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            padding: 15px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            cursor: pointer;
            transition: transform 0.2s;
            border: 1px solid #333;
            position: relative;
        }

        .card:active { transform: scale(0.98); }

        .card-img {
            width: 100%;
            aspect-ratio: 3/4;
            object-fit: cover;
            background-color: #333;
        }

        .card-info { padding: 8px; text-align: center; }

        .card-no {
            position: absolute;
            top: 5px;
            left: 5px;
            background: rgba(0,0,0,0.7);
            color: var(--gold);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            border: 1px solid var(--gold);
        }

        .card-name { font-size: 13px; color: #eee; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .card-nickname { color: var(--gold); font-size: 12px; margin-top: 2px; }

        .btn-vote-card {
            width: 100%;
            background: transparent;
            border: 1px solid var(--gold);
            color: var(--gold);
            padding: 5px;
            margin-top: 8px;
            border-radius: 4px;
            font-size: 11px;
        }

        /* --- Modal (Popup) ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡∏°‡πà! --- */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.85);
            justify-content: center;
            align-items: center; /* ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠ */
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: var(--card-bg);
            width: 85%;
            max-width: 380px;
            
            /* üî• ‡∏à‡∏∏‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏ô 85% ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ */
            max-height: 85vh; 
            overflow-y: auto; /* ‡∏ñ‡πâ‡∏≤‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏¢‡∏≤‡∏ß ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏•‡∏á‡πÑ‡∏î‡πâ */
            
            padding: 20px;
            border: 1px solid var(--gold);
            border-radius: 15px;
            position: relative;
            text-align: center;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.2);
        }

        /* ‡∏õ‡∏£‡∏±‡∏ö Scrollbar ‡πÉ‡∏´‡πâ‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° */
        .modal-content::-webkit-scrollbar { width: 4px; }
        .modal-content::-webkit-scrollbar-thumb { background: var(--gold); border-radius: 4px; }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            color: #aaa;
            font-size: 24px;
            cursor: pointer;
            z-index: 10;
        }

        .modal-img {
            width: 100px; /* ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ‡∏•‡∏á */
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--gold);
            margin-bottom: 10px;
            margin-top: 10px;
        }

        .qr-section {
            background: #fff;
            padding: 8px;
            border-radius: 8px;
            display: inline-block;
            margin: 10px 0;
        }
        
        .qr-code {
            width: 120px; /* ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î QR ‡∏•‡∏á */
            height: 120px;
            object-fit: contain;
        }

        .price-tag {
            background: #2a2a2a;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 11px; /* ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ */
            text-align: left;
            border-left: 3px solid var(--gold);
        }
        
        .price-tag div { margin-bottom: 4px; }

        .file-upload { position: relative; display: block; margin-top: 10px; }
        input[type="file"] { display: none; }

        .custom-file-upload {
            display: block;
            border: 1px dashed var(--gold);
            padding: 12px;
            cursor: pointer;
            border-radius: 8px;
            color: var(--gold);
            font-size: 13px;
            background: rgba(212, 175, 55, 0.05);
        }

        .btn-confirm {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #d4af37, #b8860b);
            border: none;
            border-radius: 25px;
            color: #000;
            font-size: 16px;
            font-weight: bold;
            margin-top: 15px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>Miss Seven Queen 2026</h1>
        <p>Official Voting System</p>
    </div>

    <div class="grid-container" id="grid">
        </div>

    <div id="voteModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            
            <img id="modalImg" src="" class="modal-img">
            <h3 id="modalName" style="color:var(--gold); margin:0; font-size:18px;"></h3>
            <p id="modalNo" style="color:#888; margin-top:2px; font-size:12px;"></p>

            <hr style="border-color:#333; margin: 10px 0; opacity:0.3;">

            <div style="font-size:12px; color:#ccc;">‡∏™‡πÅ‡∏Å‡∏ô QR ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</div>
            <div class="qr-section">
                <img src="https://placehold.co/150?text=QR+CODE" class="qr-code">
            </div>
            <div style="font-size:10px; color:#aaa; margin-bottom:10px;">
                ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡∏™‡∏¥‡∏Å‡∏£‡πÑ‡∏ó‡∏¢ xxx-x-xxxxx-x<br>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡∏Å‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏ß‡∏î...
            </div>

            <div class="price-tag">
                <div>üí∞ <b>100+ ‡∏ö‡∏≤‡∏ó</b> : 1 ‡∏ö‡∏≤‡∏ó = 1 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
                <div>üî• <b>1,000 ‡∏ö‡∏≤‡∏ó</b> : ‡∏£‡∏±‡∏ö 1,150 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
                <div>üëë <b>10,000 ‡∏ö‡∏≤‡∏ó</b> : ‡∏£‡∏±‡∏ö 13,000 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
            </div>

            <label class="file-upload">
                <input type="file" id="slipFile" accept="image/*" onchange="previewFile()">
                <div class="custom-file-upload" id="uploadLabel">
                    <i class="fas fa-cloud-upload-alt"></i> ‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ
                </div>
            </label>

            <button id="btnConfirm" class="btn-confirm" onclick="submitVote()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÇ‡∏´‡∏ß‡∏ï</button>
            <div id="status" style="margin-top:10px; font-size:12px;"></div>
        </div>
    </div>

    <script>
        const contestants = [
            { id: "01", name: "‡∏ò‡∏¥‡∏ï‡∏¥‡∏ô‡∏≤‡∏é ‡∏´‡∏•‡∏ß‡∏á‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå", nickname: "‡πÄ‡∏Å‡∏£‡∏ó", img: "https://placehold.co/300x400?text=No.1+Great" },
            { id: "02", name: "‡∏™‡∏¥‡∏£‡∏µ‡∏ò‡∏£ ‡πÇ‡∏™‡∏ò‡∏£", nickname: "‡∏≠‡∏≠‡∏á‡∏≠‡∏≠‡∏•", img: "https://placehold.co/300x400?text=No.2+Aong-all" },
            { id: "03", name: "‡∏Å‡∏ä‡∏û‡∏£ ‡∏Æ‡∏≠‡∏û‡∏Ñ‡∏¥‡∏ô‡∏™‡πå", nickname: "‡πÄ‡∏à‡∏ô‡∏ô‡∏µ‡πà", img: "https://placehold.co/300x400?text=No.3+Jenny" },
            { id: "04", name: "‡∏ô‡∏§‡∏†‡∏£ ‡∏¢‡∏∏‡∏ó‡∏ò‡∏ô‡∏≤", nickname: "‡∏û‡∏µ", img: "https://placehold.co/300x400?text=No.4+P" },
            { id: "05", name: "‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏≤‡∏â‡∏ß‡∏µ ‡πÉ‡∏à‡∏ä‡πà‡∏ß‡∏á", nickname: "‡∏°‡∏¥‡πâ‡∏ô", img: "https://placehold.co/300x400?text=No.5+Mint" },
            { id: "06", name: "‡πÄ‡∏Å‡∏ï‡∏ô‡πå‡∏ô‡∏¥‡∏†‡∏≤ ‡∏™‡∏∏‡∏à‡∏£‡∏¥‡∏ï‡∏Å‡∏∏‡∏•", nickname: "‡∏°‡∏≤‡∏¢‡∏î‡πå", img: "https://placehold.co/300x400?text=No.6+Mind" },
            { id: "07", name: "‡∏õ‡∏•‡∏≤‡∏¢‡∏ü‡πâ‡∏≤ ‡∏ó‡∏≠‡∏á‡∏î‡∏≠‡∏ô‡∏û‡∏∏‡πà‡∏°", nickname: "‡∏õ‡∏•‡∏≤‡∏¢‡∏ü‡πâ‡∏≤", img: "https://placehold.co/300x400?text=No.7+Plaifah" },
            { id: "08", name: "‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏ô‡∏Å ‡∏ß‡∏±‡∏í‡∏ô‡∏û‡∏á‡∏®‡πå‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£", nickname: "‡πÄ‡∏ü‡∏¥‡∏ô", img: "https://placehold.co/300x400?text=No.8+Fern" },
            { id: "09", name: "‡πÑ‡∏Å‡∏£‡∏Å‡∏°‡∏• ‡∏™‡∏≤‡∏£‡∏î‡∏¥‡∏©‡∏ê‡πå", nickname: "‡∏Ñ‡∏ß‡∏µ‡∏ô", img: "https://placehold.co/300x400?text=No.9+Queen" },
            { id: "10", name: "‡∏™‡∏∏‡∏Å‡∏±‡∏ç‡∏ç‡∏≤ ‡πÄ‡∏ï‡∏∑‡πà‡∏≠‡∏¢‡∏°‡∏≤", nickname: "‡πÅ‡∏õ‡πâ‡∏á", img: "https://placehold.co/300x400?text=No.10+Pang" },
            { id: "11", name: "‡∏î‡∏ß‡∏á‡∏´‡∏ó‡∏±‡∏¢ ‡∏û‡∏¥‡∏ì‡∏ó‡∏≠‡∏á", nickname: "‡∏ü‡πâ‡∏≤‡πÉ‡∏™", img: "https://placehold.co/300x400?text=No.11+Fahsai" },
            { id: "12", name: "‡∏ô‡∏±‡∏¢‡∏ô‡∏≤ ‡πÅ‡∏ã‡πà‡∏•‡∏¥‡πâ‡∏°", nickname: "‡πÄ‡∏°", img: "https://placehold.co/300x400?text=No.12+May" },
            { id: "13", name: "‡∏ô‡∏≤‡∏ñ‡∏§‡∏î‡∏µ ‡∏ß‡∏á‡∏®‡πå‡∏Ç‡∏≤‡∏ß", nickname: "‡∏Å‡∏¥‡∏°‡∏´‡∏á‡∏©‡πå", img: "https://placehold.co/300x400?text=No.13+Kimhong" },
            { id: "14", name: "‡∏™‡∏°‡∏§‡∏ó‡∏±‡∏¢ ‡∏ß‡∏á‡∏®‡πå‡∏Å‡∏ß‡∏ô", nickname: "‡∏´‡∏°‡∏¥‡∏ß", img: "https://placehold.co/300x400?text=No.14+Mew" },
            { id: "15", name: "‡∏õ‡∏≤‡∏£‡∏î‡∏≤ ‡∏´‡∏±‡∏á‡∏™‡∏û‡∏§‡∏Å‡∏©‡πå", nickname: "‡πÑ‡∏Ç‡πà‡∏°‡∏∏‡∏Å", img: "https://placehold.co/300x400?text=No.15+Kaimook" }
        ];

        // ‚ö†Ô∏è BACKEND URL (‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô)
        const BACKEND_URL = "https://miss-seven-queen-api.vercel.app/";
        const LIFF_ID = "1660826063-Cy2t8mh6";
        
        let currentContestantId = null;

        async function init() {
            await liff.init({ liffId: LIFF_ID });
            if (!liff.isLoggedIn()) liff.login();
            renderGrid();
        }
        init();

        function renderGrid() {
            const grid = document.getElementById('grid');
            // ‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™ M7Q-XX
            grid.innerHTML = contestants.map(c => `
                <div class="card" onclick="openModal('${c.id}')">
                    <div class="card-no">M7Q-${c.id}</div>
                    <img src="${c.img}" class="card-img" loading="lazy">
                    <div class="card-info">
                        <div class="card-name">${c.name}</div>
                        <div class="card-nickname">"${c.nickname}"</div>
                        <button class="btn-vote-card">VOTE</button>
                    </div>
                </div>
            `).join('');
        }

        function openModal(id) {
            const c = contestants.find(x => x.id === id);
            currentContestantId = id;
            
            document.getElementById('modalImg').src = c.img;
            document.getElementById('modalName').innerText = c.nickname;
            // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏´‡∏±‡∏™ M7Q-XX ‡πÉ‡∏ô Modal
            document.getElementById('modalNo').innerText = `Code: M7Q-${c.id} | ${c.name}`;
            
            // Reset
            document.getElementById('slipFile').value = "";
            document.getElementById('uploadLabel').innerHTML = '<i class="fas fa-cloud-upload-alt"></i> ‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ';
            document.getElementById('uploadLabel').style.borderColor = "#d4af37";
            document.getElementById('uploadLabel').style.color = "#d4af37";
            document.getElementById('status').innerText = "";
            
            document.getElementById('voteModal').style.display = "flex";
        }

        function closeModal() {
            document.getElementById('voteModal').style.display = "none";
        }

        window.onclick = function(event) {
            if (event.target == document.getElementById('voteModal')) {
                closeModal();
            }
        }

        function previewFile() {
            const file = document.getElementById('slipFile').files[0];
            if(file) {
                document.getElementById('uploadLabel').innerHTML = `<i class="fas fa-check"></i> ‡πÅ‡∏ô‡∏ö‡πÅ‡∏•‡πâ‡∏ß: ${file.name.substring(0, 15)}...`;
                document.getElementById('uploadLabel').style.borderColor = "#00ff00";
                document.getElementById('uploadLabel').style.color = "#00ff00";
            }
        }

        async function submitVote() {
            // ... (Logic ‡πÄ‡∏î‡∏¥‡∏°) ...
             const fileInput = document.getElementById('slipFile');
            const status = document.getElementById('status');
            const btn = document.getElementById('btnConfirm');

            if (!fileInput.files[0]) {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡πà‡∏∞");
                return;
            }

            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...';

            const reader = new FileReader();
            reader.readAsDataURL(fileInput.files[0]);
            reader.onload = async () => {
                const base64Image = reader.result.split(',')[1];

                try {
                    const response = await fetch(BACKEND_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ image: base64Image, contestantNo: currentContestantId })
                    });
                    const result = await response.json();

                    if (result.success) {
                        status.innerHTML = `<span style="color:#d4af37">‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! +${result.points} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</span>`;
                        alert(`‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏∞! ‡πÇ‡∏´‡∏ß‡∏ï‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ${result.points} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô`);
                        closeModal();
                    } else {
                        status.innerHTML = `<span style="color:red">‚ùå ${result.message}</span>`;
                        btn.innerHTML = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÇ‡∏´‡∏ß‡∏ï';
                    }
                } catch (err) {
                    status.innerText = "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠";
                    btn.innerHTML = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÇ‡∏´‡∏ß‡∏ï';
                } finally {
                    btn.disabled = false;
                }
            };
        }
    </script>
</body>
</html>